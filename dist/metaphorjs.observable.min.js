(function(){var r={lib:{}},s=function(){var h=["0","0","0"];return function(){for(var a=h.length,b;a;){a--;b=h[a].charCodeAt(0);if(57==b)return h[a]="A",h.join("");if(90==b)h[a]="0";else return h[a]=String.fromCharCode(b+1),h.join("")}h.unshift("0");return h.join("")}}(),l=Array.prototype.slice,n=function(h){return!(!h||h.constructor!==Object)},m=function(h){return"undefined"==typeof h},t=function a(){var b=!1,c=!1,d=l.call(arguments),e=d.shift(),g,f,k;"boolean"==typeof d[d.length-1]&&(b=d.pop());
"boolean"==typeof d[d.length-1]&&(c=b,b=d.pop());for(;d.length;)if(g=d.shift())for(f in g)if(g.hasOwnProperty(f)&&!m(k=g[f]))if(c)if(e[f]&&n(e[f])&&n(k))a(e[f],k,b,c);else{if(!0===b||m(e[f])||null===e[f])n(k)?(e[f]={},a(e[f],k,b,!0)):e[f]=k}else if(!0===b||m(e[f])||null===e[f])e[f]=k;return e},u=Function.prototype.bind?function(a,b){return a.bind(b)}:function(a,b){return function(){return a.apply(b,arguments)}},p=function(){this.events={}};p.prototype={createEvent:function(a,b){a=a.toLowerCase();
var c=this.events;c[a]||(c[a]=new q(a,b));return c[a]},getEvent:function(a){a=a.toLowerCase();return this.events[a]},on:function(a,b,c,d){a=a.toLowerCase();var e=this.events;e[a]||(e[a]=new q(a));return e[a].on(b,c,d)},once:function(a,b,c,d){d=d||{};d.limit=1;return this.on(a,b,c,d)},un:function(a,b,c){a=a.toLowerCase();var d=this.events;d[a]&&d[a].un(b,c)},hasListener:function(a,b,c){a=a.toLowerCase();var d=this.events;return d[a]?d[a].hasListener(b,c):!1},removeAllListeners:function(a){var b=this.events;
b[a]&&b[a].removeAllListeners()},trigger:function(){var a=arguments[0],b=this.events,a=a.toLowerCase();if(!b[a])return null;a=b[a];return a.trigger.apply(a,l.call(arguments,1))},suspendEvent:function(a){a=a.toLowerCase();var b=this.events;b[a]&&b[a].suspend()},suspendAllEvents:function(){var a=this.events,b;for(b in a)a[b].suspend()},resumeEvent:function(a){a=a.toLowerCase();var b=this.events;b[a]&&b[a].resume()},resumeAllEvents:function(){var a=this.events,b;for(b in a)a[b].resume()},destroyEvent:function(a){var b=
this.events;b[a]&&(b[a].removeAllListeners(),b[a].destroy(),delete b[a])},destroy:function(a){var b=this.events;if(a)a=a.toLowerCase(),b[a]&&(b[a].destroy(),delete b[a]);else{for(var c in b)b[c].destroy();this.events={}}},getApi:function(){if(!this.api){for(var a="createEvent getEvent on un once hasListener removeAllListeners trigger suspendEvent suspendAllEvents resumeEvent resumeAllEvents destroyEvent".split(" "),b={},c,d=-1,e=a.length;++d<e;c=a[d],b[c]=u(this[c],this));this.api=b}return this.api}};
var q=function(a,b){this.name=a;this.listeners=[];this.map={};this.hash=s();this.uni="$$"+a+"_"+this.hash;this.suspended=!1;this.lid=0;this.returnResult=m(b)?null:b};q.prototype={getName:function(){return this.name},destroy:function(){this.map=this.listeners=null},on:function(a,b,c){if(!a)return null;b=b||null;c=c||{};var d=this.uni,e=b||a;if(e[d]&&!c.allowDupes)return null;var g=++this.lid,f=c.first||!1;e[d]=g;a={fn:a,scope:b,uniScope:e,id:g,called:0,limit:c.limit||0,start:c.start||1,count:0,append:c.append,
prepend:c.prepend};f?this.listeners.unshift(a):this.listeners.push(a);this.map[g]=a;return g},once:function(a,b,c){c=c||{};c.once=!0;return this.on(a,b,c)},un:function(a,b){var c=-1,d=this.uni,e=this.listeners,g;g=a==parseInt(a)?a:(b||a)[d];if(!g)return!1;for(var f=0,k=e.length;f<k;f++)if(e[f].id==g){c=f;delete e[f].uniScope[d];break}if(-1==c)return!1;e.splice(c,1);delete this.map[g];return!0},hasListener:function(a,b){var c=this.listeners,d;if(a){d="function"!==typeof a?a:(b||a)[this.uni];if(!d)return!1;
for(var e=0,g=c.length;e<g;e++)if(c[e].id==d)return!0;return!1}return 0<c.length},removeAllListeners:function(){var a=this.listeners,b=this.uni,c,d;c=0;for(d=a.length;c<d;c++)delete a[c].uniScope[b];this.listeners=[];this.map={}},suspend:function(){this.suspended=!0},resume:function(){this.suspended=!1},_prepareArgs:function(a,b){var c;a.append||a.prepend?(c=l.call(b),a.prepend&&(c=a.prepend.concat(c)),a.append&&(c=c.concat(a.append))):c=b;return c},trigger:function(){var a=this.listeners,b=this.returnResult;
if(this.suspended||0==a.length)return null;for(var c="all"==b?[]:null,d,e,a="first"==b?[a[0]]:l.call(a);d=a.shift();)if(d&&this.map[d.id]&&(d.count++,!(d.count<d.start))){e=d.fn.apply(d.scope,this._prepareArgs(d,arguments));d.called++;d.called==d.limit&&this.un(d.id);"all"==b&&c.push(e);if("first"==b)return e;"last"==b&&(c=e);if(!1==b&&!1===e)break}if(b)return c}};(function(){var a=new p;t(r,a.getApi(),!0,!1)})();r.lib.Observable=p})();
