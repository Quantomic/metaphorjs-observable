(function(){'use strict';(function(){var n=window.MetaphorJs&&MetaphorJs.nextUid?MetaphorJs.nextUid:function(){return Array(11).join((Math.random().toString(36)+"00000000000000000").slice(2,18)).slice(0,10)},l=function(a){var b,c,e,d;c=1;for(e=arguments.length;c<e;c++)for(b in d=arguments[c],d)a[b]=d[b]},k=function(){this.events={}};l(k.prototype,{createEvent:function(a,b){a=a.toLowerCase();var c=this.events;c[a]||(c[a]=new m(a,b));return c[a]},getEvent:function(a){a=a.toLowerCase();return this.events[a]},on:function(a,
b,c,e){a=a.toLowerCase();var d=this.events;d[a]||(d[a]=new m(a));return d[a].on(b,c,e)},once:function(a,b,c,e){e=e||{};e.limit=1;return this.on(a,b,c,e)},un:function(a,b,c){a=a.toLowerCase();var e=this.events;e[a]&&e[a].un(b,c)},hasListener:function(a,b,c){a=a.toLowerCase();var e=this.events;return e[a]?e[a].hasListener(b,c):!1},removeAllListeners:function(a){var b=this.events;b[a]&&b[a].removeAllListeners()},trigger:function(){var a=arguments[0],b=this.events,a=a.toLowerCase();if(!b[a])return null;
a=b[a];return a.trigger.apply(a,Array.prototype.slice.call(arguments,1))},suspendEvent:function(a){a=a.toLowerCase();var b=this.events;b[a]&&b[a].suspend()},suspendAllEvents:function(){var a=this.events,b;for(b in a)a[b].suspend()},resumeEvent:function(a){a=a.toLowerCase();var b=this.events;b[a]&&b[a].resume()},resumeAllEvents:function(){var a=this.events,b;for(b in a)a[b].resume()},destroyEvent:function(a){var b=this.events;b[a]&&(b[a].removeAllListeners(),b[a].destroy(),delete b[a])},destroy:function(a){var b=
this.events;if(a)a=a.toLowerCase(),b[a]&&(b[a].destroy(),delete b[a]);else{for(var c in b)b[c].destroy();this.events={}}},getApi:function(){var a=this;if(!a.api){var b={},c;for(c in a)"function"==typeof a[c]&&"destroy"!=c&&"getApi"!=c&&(b[c]=function(b){return function(){return b.apply(a,arguments)}}(a[c]));a.api=b}return a.api}});var m=function(a,b){this.name=a;this.listeners=[];this.map={};this.hash=n();this.uni="$$"+a+"_"+this.hash;this.suspended=!1;this.lid=0;this.returnResult=b||!1};l(m.prototype,
{destroy:function(){this.map=this.listeners=null},on:function(a,b,c){if(!a)return null;b=b||a;c=c||{};var e=this.uni;if(b[e]&&!c.allowDupes)return null;var d=++this.lid,f=c.first||!1;b[e]=d;a={fn:a,scope:b,id:d,called:0,limit:c.limit||0,start:c.start||1,count:0,append:c.append,prepend:c.prepend};f?this.listeners.unshift(a):this.listeners.push(a);this.map[d]=a;return d},un:function(a,b){var c=-1,e=this.uni,d=this.listeners,f;f=a==parseInt(a)?a:(b||a)[e];if(!f)return!1;for(var g=0,h=d.length;g<h;g++)if(d[g].id==
f){c=g;delete d[g].scope[e];break}if(-1==c)return!1;d.splice(c,1);delete this.map[f];return!0},hasListener:function(a,b){var c=this.listeners,e;if(a){b=b||a;e=a==parseInt(a)?a:b[this.uni];if(!e)return!1;for(var d=0,f=c.length;d<f;d++)if(c[d].id==e)return!0;return!1}return 0<c.length},removeAllListeners:function(){var a=this.listeners,b=this.uni,c,e;c=0;for(e=a.length;c<e;c++)delete a[c].scope[b];this.listeners=[];this.map={}},suspend:function(){this.suspended=!0},resume:function(){this.suspended=
!1},trigger:function(){var a=this.listeners,b=this.returnResult,c=Array.prototype.slice;if(this.suspended||0==a.length)return null;var e="all"==b?[]:null,d,f=[],g;d=0;for(g=a.length;d<g;d++)f.push(a[d]);for(;a=f.shift();)if(a&&this.map[a.id]&&(a.count++,!(a.count<a.start))){a.append||a.prepend?(d=c.call(arguments),a.prepend&&(d=a.prepend.concat(d)),a.append&&(d=d.concat(a.append))):d=arguments;d=a.fn.apply(a.scope,d);a.called++;a.called==a.limit&&this.un(a.id);"all"==b&&null!==d&&e.push(d);if("first"==
b&&null!==d)return d;"last"==b&&null!==d&&(e=d);if(!1==b&&!1===d)break}if(b)return e}});var h=window.MetaphorJs;if(h&&h.VERSION){var p=new k;l(MetaphorJs,p.getApi())}h&&h.r?h.r("MetaphorJs.lib.Observable",k):(window.MetaphorJs=window.MetaphorJs||{},MetaphorJs.lib=MetaphorJs.lib||{},MetaphorJs.lib.Observable=k)})();
}());