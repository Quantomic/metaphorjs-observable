/*
 * MetaphorJs.lib.Observable 1.1
 * @author johann kuindji
 * @github https://github.com/kuindji/metaphorjs-observable
 */
(function(){var a=function(){var e=10;return new Array(e+1).join((Math.random().toString(36)+"00000000000000000").slice(2,18)).slice(0,e)};var d=function(f){var h,g,e,k;for(g=1,e=arguments.length;g<e;g++){k=arguments[g];for(h in k){f[h]=k[h]}}};var b=function(f,k){var h=[],j=a(),g=false,i=0,e=this,k=k||false;d(e,{destroy:function(){h=null;j=null;g=null;i=null;e=null;f=null},on:function(n,m,l){if(!n){return}m=m||n;l=l||{};var q=f+"_"+j;if(m[q]){return}var r=++i,p=l.first||false;m[q]=r;var o={fn:n,scope:m,id:r,called:0,limit:l.limit?l.limit:(l.once?1:0),start:l.start||1,count:0};if(p){h.unshift(o)}else{h.push(o)}return r},un:function(o,n){var q=-1,p=f+"_"+j,r;if(o==parseInt(o)){r=o}else{n=n||o;r=n[p]}if(!r){return false}for(var m=0,l=h.length;m<l;m++){if(h[m].id==r){q=m;delete h[m].scope[p];break}}if(q==-1){return false}h.splice(q,1);return true},hasListener:function(o,n){if(o){n=n||o;var q,p=f+"_"+j;if(o==parseInt(o)){q=o}else{q=n[p]}if(!q){return false}for(var m=0,l=h.length;m<l;m++){if(h[m].id==q){return true}}return false}else{return h.length>0?h.length:false}},removeAllListeners:function(){var n=f+"_"+j;for(var m=0,l=h.length;m<l;m++){delete h[m].scope[n]}h=[]},suspend:function(){g=true},resume:function(){g=false},trigger:function(){if(g||h.length==0){return}var o=k=="all"?[]:null,q;for(var p=0,m=h.length;p<m;p++){var n=h[p];n.count++;if(n.count<n.start){continue}q=n.fn.apply(n.scope,arguments);n.called++;if(n.called==n.limit){e.removeListener(n.id)}if(k=="all"){o.push(q)}if(k=="first"&&q){return q}if(k=="last"&&q){o=q}if(k==false&&q===false){break}}if(k){return o}}})};var c=function(){var e=this,f={},g={};d(g,{createEvent:function(h,i){h=h.toLowerCase();if(!f[h]){f[h]=new b(h,i)}return f[h]},getEvent:function(h){h=h.toLowerCase();return f[h]},on:function(i,k,j,h){i=i.toLowerCase();if(!f[i]){f[i]=new b(i)}return f[i].on(k,j,h)},once:function(i,k,j,h){h=h||{};h.limit=1;return e.on(i,k,j,h)},un:function(h,j,i){h=h.toLowerCase();if(!f[h]){return}f[h].un(j,i)},hasListener:function(h,j,i){h=h.toLowerCase();if(!f[h]){return false}return f[h].hasListener(j,i)},removeAllListeners:function(h){if(!f[h]){return}f[h].removeAllListeners()},trigger:function(){var j=[],k=arguments[0];k=k.toLowerCase();if(!f[k]){return}for(var l=1,h=arguments.length;l<h;l++){j.push(arguments[l])}var m=f[k];return m.trigger.apply(m,j)},suspendEvent:function(h){h=h.toLowerCase();if(!f[h]){return}f[h].suspend()},suspendAllEvents:function(){for(var h in f){f[h].suspend()}},resumeEvent:function(h){h=h.toLowerCase();if(!f[h]){return}f[h].resume()},resumeAllEvents:function(){for(var h in f){f[h].resume()}}});d(e,g,{destroy:function(h){if(h){h=h.toLowerCase();if(f[h]){f[h].destroy();delete f[h]}}else{for(var j in f){f[j].destroy()}f=null;e=null}},getApi:function(){return g}});return e};if(window.MetaphorJs&&MetaphorJs.ns){MetaphorJs.ns.register("MetaphorJs.lib.Observable",c)}else{window.MetaphorJs=window.MetaphorJs||{};MetaphorJs.lib=MetaphorJs.lib||{};MetaphorJs.lib.Observable=c}})();